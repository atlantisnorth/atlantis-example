version: 3
automerge: true
delete_source_branch_on_merge: true
projects:
  - name: test
    dir: .
    workspace: default
    # terraform_version: v0.11.0
    # delete_source_branch_on_merge: true
    # autoplan:
    #   when_modified: ["*.tf", "../modules/**.tf"]
    #   enabled: false
    apply_requirements: [mergeable]
    workflow: myworkflow
workflows:
  myworkflow:
    plan:
      steps:
        - run: rm -rf .terraform
        - init:
          extra_args: [-upgrade=false]
        - plan:
            extra_args: ["-lock", "false"]
    apply:
      steps:
        - apply
